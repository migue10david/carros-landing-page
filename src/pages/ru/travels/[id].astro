---
import { render } from "astro:content";
import { getCollection, type CollectionEntry } from "astro:content";
import Carousel from "../../../components/Carousel.astro";
import Layout from "../../../layouts/Layout.astro";
import Features from "../../../components/Features.astro";
import HavanaCard from "@/components/HavanaCard.astro";
import {havanaTravelsRussian, cienfuegosTrinidadRussianTravels} from "@/lib/havana";
import { HavanaRussianTabs } from "@/components/HavanaRussianTabs";
import { CienfuegosTrinidadRussianTabs } from "@/components/CienfuegosTrinidadRussianTabs";
import { getLangFromUrl } from "../../../i18n/utils";
import { SITE_LOGO } from "../../../content/site";

export async function getStaticPaths() {
  const travels = await getCollection("rusian");
  type TravelEntry = CollectionEntry<"rusian">;

  return travels.map((travel: TravelEntry) => ({
    params: { id: travel.slug },
    props: { travel },
  }));
}

const { travel } = Astro.props;
const { data, slug } = travel;
const { title, description, images, feautures } = data;
const { Content } = await render(travel);

const image = SITE_LOGO;

const routeLang = getLangFromUrl(Astro.url);
const lang = routeLang ?? "en";

// Construir URL canónica
const pathname = Astro.url.pathname;

const url: string = "";
const noIndex: boolean = false;

---

<Layout
  title={title}
  description={description[0]}
  image={images[0]}
  url={url}
  lang={lang}
  noIndex={noIndex}
>
  <div class="mx-auto max-w-7xl px-5 py-12 sm:py-16 lg:px-8">
    <!-- Título -->
    <h1
      class="mb-6 text-center text-3xl font-extrabold text-gray-900 dark:text-white sm:text-4xl"
    >
      {
        title === "Матансас" || title === "Карибское побережье"
          ? "Экскурсия"
          : "Экскурсии"
      } в {title === "Гавана" ? "Гавану" : title}
    </h1>
    <Carousel images={images} />
    <!-- Descripción -->
    <p
      class="mb-8 text-justify text-sm md:text-lg dark:text-gray-300 leading-relaxed"
    >
      {description}
    </p>

    <Content />Сьенфуэгос-Тринидад
    {
      slug === "havana" ? (
        <h1 class="pb-3 text-center  font-extrabold text-gray-900 dark:text-white text-2xl">
          Другие экскурсии в Гавану
        </h1>
      ) : null
    }
    {
      slug === "havana" ? (
        <h1 class="pb-3 text-center  font-extrabold text-gray-900 dark:text-white text-2xl">
          Другие экскурсии в Сьенфуэгос-Тринидад
        </h1>
      ) : null
    }
    {slug === "havana" ? <HavanaRussianTabs client:load /> : null}
    <div class="flex flex-col gap-3">
      {
        slug === "havana" ? (
          <HavanaCard
            title={havanaTravelsRussian[0].title}
            description={havanaTravelsRussian[0].description}
            images={havanaTravelsRussian[0].images}
            slug={slug}
            link={havanaTravelsRussian[0].link}
          />
        ) : null
      }
      {
        slug === "havana" ? (
          <HavanaCard
            title={havanaTravelsRussian[1].title}
            description={havanaTravelsRussian[1].description}
            images={havanaTravelsRussian[1].images}
            slug={slug}
            link={havanaTravelsRussian[1].link}
          />
        ) : null
      }
      {
        slug === "havana" ? (
          <HavanaCard
            title={havanaTravelsRussian[2].title}
            description={havanaTravelsRussian[2].description}
            images={havanaTravelsRussian[2].images}
            slug={slug}
            link={havanaTravelsRussian[2].link}
          />
        ) : null
      }

      {
        slug === "cienfuegos-trinidad" ? (
          <CienfuegosTrinidadRussianTabs client:load />
        ) : null
      }
      <div class="flex flex-col gap-3">
        {
          slug === "cienfuegos-trinidad" ? (
            <HavanaCard
              title={cienfuegosTrinidadRussianTravels[0].title}
              description={cienfuegosTrinidadRussianTravels[0].description}
              images={cienfuegosTrinidadRussianTravels[0].images}
              slug={slug}
              link={cienfuegosTrinidadRussianTravels[0].link}
            />
          ) : null
        }
        {
          slug === "cienfuegos-trinidad" ? (
            <HavanaCard
              title={cienfuegosTrinidadRussianTravels[1].title}
              description={cienfuegosTrinidadRussianTravels[1].description}
              images={cienfuegosTrinidadRussianTravels[1].images}
              slug={slug}
              link={cienfuegosTrinidadRussianTravels[1].link}
            />
          ) : null
        }
      </div>
      <Features images={feautures} />
    </div>
  </div>
  ---
</Layout>
